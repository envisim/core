import { describe } from "vitest";
import { Weibull } from "../../src/index.js";
import { distributionTests, fromTo } from "../_distributions.testf.js";

describe("Weibull(1, 1)", () => {
  const pdf = [
    1.0, 0.778800783071404878477, 0.606530659712633424263, 0.472366552741014689154,
    0.367879441171442334024, 0.286504796860190091845, 0.223130160148429818046,
    0.17377394345044513968, 0.135335283236612702318, 0.105399224561864332528,
    0.082084998623898799974, 0.063927861206707570219, 0.049787068367863944462,
  ];
  const cdf = [
    0.0, 0.22119921692859512152, 0.39346934028736657574, 0.52763344725898531085,
    0.63212055882855766598, 0.71349520313980985264, 0.77686983985157020971, 0.82622605654955494359,
    0.86466471676338729768, 0.89460077543813565359, 0.91791500137610126941, 0.93607213879329242978,
    0.9502129316321360486,
  ];
  const quantile = [
    0.0,
    0.10536051565782630912,
    0.22314355131420976486,
    0.35667494393873233616,
    0.51082562376599072174,
    0.69314718055994528623,
    0.91629073187415499557,
    1.20397280432593589694,
    1.60943791243410050384,
    2.30258509299404590109,
    Infinity,
  ];
  const x = fromTo(0, 3.01, 0.25);

  distributionTests(new Weibull(1.0, 1.0), { x, pdf, cdf, quantile });
});

describe("Weibull(0.5, 1)", () => {
  const pdf = [
    Infinity,
    0.486172730625805293858,
    0.270654763023310540593,
    0.183939720585721167012,
    0.136464775150513306645,
    0.106505948473758979556,
    0.085954745769180940229,
    0.071053558417588216778,
    0.059811641149369466908,
    0.051072753046457246284,
    0.044118528336795900802,
    0.038478990492246178956,
    0.033833820809153175579,
  ];
  const cdf = [
    0.0, 0.43861608620107184198, 0.55802262275932601465, 0.63212055882855766598,
    0.68484810132779760927, 0.72500282352607081648, 0.75688326556578577886, 0.7829277934369569536,
    0.80465599800745502002, 0.82307879368223579863, 0.83890191217337339857, 0.85263668569450046242,
    0.86466471676338729768,
  ];
  const quantile = [
    0.0,
    0.011100838259683063272,
    0.049793044493117367966,
    0.12721701563369786081,
    0.260942817895913503623,
    0.480453013918201388144,
    0.83958870531847462626,
    1.449550513556458364306,
    2.590290393980235528204,
    5.301898110478399317458,
    Infinity,
  ];
  const x = fromTo(0, 4.01, 1.0 / 3.0);

  distributionTests(new Weibull(0.5, 1.0), { x, pdf, cdf, quantile });
});

describe("Weibull(2, 1)", () => {
  const pdf = [
    0.0, 0.384315775660929281887, 0.681715031172969165851, 0.837211591285237255455,
    0.843667878468877696641, 0.735758882342884668049, 0.568626620837092255911,
    0.394403578578926050646, 0.247375169418559082146, 0.140990022356353439381,
    0.073262555554936714675,
  ];
  const cdf = [
    0.0, 0.039210560847676795282, 0.147856211033788681464, 0.30232367392896891678,
    0.472707575956951508989, 0.632120558828557665976, 0.7630722413178782082,
    0.859141579078954942261, 0.922695259556700286829, 0.960836104901012899582,
    0.981684361111265779698,
  ];
  const quantile = [
    0.0,
    0.32459284597450127619,
    0.47238072707743883338,
    0.59722269208288825126,
    0.71472066135378420348,
    0.83255461115769768821,
    0.9572307620809911155,
    1.09725694544438212574,
    1.26863624117951978576,
    1.51742712938514645593,
    Infinity,
  ];
  const x = fromTo(0, 2.01, 0.2);

  distributionTests(new Weibull(2.0, 1.0), { x, pdf, cdf, quantile });
});
