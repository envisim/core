import {describe} from 'vitest';

import {Poisson as Dist} from '../src/poisson';
import {distTests, fromTo} from './_distributions.testf';

describe('poisson(4)', () => {
  const pdf = [
    0.0183156388887341786686, 0.0732625555549367424302,
    0.1465251111098734571048, 0.1953668148131646187249,
    0.1953668148131645909693, 0.1562934518505316727754,
    0.1041956345670211198096, 0.0595403626097263521944,
    0.0297701813048631795666, 0.0132311916910503035716,
    0.0052924766764201203878,
  ];
  const cdf = [
    0.018315638888734178669, 0.091578194443670934977, 0.238103305553544364326,
    0.433470120366709010806, 0.628836935179873490753, 0.785130387030405274551,
    0.889326021597426352727, 0.948866384207152635533, 0.978636565512015832446,
    0.991867757203066080507, 0.997160233879486268549,
  ];
  const quantile = [0, 2, 2, 3, 3, 4, 4, 5, 6, 7, Infinity];
  const x = fromTo(0, 10, 1);
  const params = {rate: 4};

  distTests({Dist, x, params, pdf, cdf, quantile});
});

describe('poisson(40)', () => {
  const cdf = [
    0.1153035849, 0.2424141977, 0.3546507361, 0.4160240995, 0.5419181784,
    0.6033299241, 0.7162241633, 0.8096500884, 0.9075311614,
  ];
  const x = [32, 35, 37, 38, 40, 41, 43, 45, 48];
  const params = {rate: 40};

  distTests({
    Dist,
    x,
    params,
    pdf: [],
    cdf,
    quantile: [],
    doTests: [4],
  });
});
