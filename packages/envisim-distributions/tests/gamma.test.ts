import {describe} from 'vitest';

import {Gamma as Dist} from '../src/gamma';
import {distTests, fromTo} from './_distributions.testf';

describe('gamma(3, 2)', () => {
  const pdf = [
    0.0, 0.0919698602928605835061, 0.1353352832366127023178,
    0.1120209038276938628975, 0.0732625555549367285524,
    0.0421121687442841743931, 0.0223087695899972272839,
    0.0111705540780428248804, 0.0053674020464401905189,
    0.0024990485327552611552, 0.0011349982440621215508,
  ];
  const cdf = [
    0.0, 0.080301397071394192695, 0.323323583816936599433,
    0.576809918873156579622, 0.761896694446455580163, 0.875347980516918866556,
    0.938031195583341026456, 0.970363836119478184727, 0.986246032255997051585,
    0.993767804893622708207, 0.997230604284488397759,
  ];
  const quantile = [
    0.0,
    2.20413065649864226,
    3.0700884052892871701,
    3.8275515882541260027,
    4.5701538080067631853,
    5.3481206274471215778,
    6.2107571945266997204,
    7.2311353317319806422,
    8.5580597202506680787,
    10.6446406756684215367,
    Infinity,
  ];
  const x = fromTo(0, 20, 2);
  const params = {shape: 3, scale: 2};

  distTests({Dist, x, params, pdf, cdf, quantile});
});

describe('gamma(0.5, 2)', () => {
  const cdf = [
    0.1769367262, 0.248170366, 0.3014646417, 0.345279154, 0.3829249225,
    0.4161175792, 0.4458868699, 0.4729107431, 0.4976650456, 0.5204998778,
    0.5416823059, 0.5614219739,
  ];
  const x = fromTo(0.05, 0.601, 0.05);
  const params = {shape: 0.5, scale: 2};

  distTests({
    Dist,
    x,
    params,
    pdf: [],
    cdf,
    quantile: [],
    doTests: [4],
    randn: 200000,
  });
});
