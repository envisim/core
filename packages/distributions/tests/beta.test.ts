import {distTests, fromTo, QARR} from './_distributions.testf';
import {Beta as Dist, BetaPrime as Dist2} from '../src/beta';

describe('beta (2, 5)', () => {
  const pdf = [
    0.0, 1.9683000000000003826273, 2.4576000000000002287948,
    2.1608999999999998209432, 1.5551999999999999158007,
    0.9375000000000001110223, 0.460800000000000042899, 0.1701000000000000567102,
    0.0383999999999999827582, 0.0026999999999999979745, 0.0,
  ];
  const cdf = [
    0.0, 0.11426500000000001933, 0.34464000000000005741, 0.57982500000000014584,
    0.76672000000000006814, 0.890625, 0.95903999999999989257,
    0.98906499999999997197, 0.99839999999999995417, 0.99994499999999997275, 1.0,
  ];
  const quantile = [
    0.0, 0.092595258913128752898, 0.1398806882699578924, 0.18180347131894911139,
    0.222583533615423850849, 0.264449983295659940552, 0.309444427545314426631,
    0.360357690380020190268, 0.422447524846272015608, 0.510316306551491627452,
    1.0,
  ];
  const x = [...QARR];
  const params = {alpha: 2, beta: 5};

  distTests({Dist, x, params, pdf, cdf, quantile});
});

describe('beta (0.5, 0.2)', () => {
  const cdf = [
    0.0, 0.1037379676, 0.1512429184, 0.1915792081, 0.2297346047, 0.2681831319,
    0.3090367454, 0.3550562465, 0.411373871, 0.4923601462, 1.0,
  ];
  const params = {alpha: 0.5, beta: 0.2};
  distTests({
    Dist,
    x: [...QARR],
    params,
    pdf: [],
    cdf,
    quantile: [],
    doTests: [4],
  });
});

describe('beta (0.5, 1.2)', () => {
  const cdf = [
    0.0, 0.3507080049, 0.4923798672, 0.5983745777, 0.6852006554, 0.7591755305,
    0.8234159339, 0.8795846815, 0.9284407958, 0.969798188, 1.0,
  ];
  const params = {alpha: 0.5, beta: 1.2};
  distTests({
    Dist,
    x: [...QARR],
    params,
    pdf: [],
    cdf,
    quantile: [],
    doTests: [4],
  });
});

describe('betaprime (1, 2)', () => {
  const pdf = [
    2.0, 1.157407407407407440303, 0.728862973760933119394,
    0.488281249999999944489, 0.34293552812071326219, 0.25,
    0.187828700225394384926, 0.144675925925925930038, 0.113791533909877090602,
    0.091107871720116639924, 0.074074074074074069962,
  ];
  const cdf = [
    0.0, 0.30555555555555591329, 0.48979591836734726051, 0.609375,
    0.69135802469135798631, 0.75, 0.79338842975206613772,
    0.82638888888888895057, 0.85207100591715978499, 0.87244897959183675962,
    0.88888888888888883955,
  ];
  const quantile = [
    0.0,
    0.054092553389459778479,
    0.11803398874989487477,
    0.1952286093343938711,
    0.290994448735805599782,
    0.414213562373094978941,
    0.581138830084189650371,
    0.82574185835055347038,
    1.236067977499790027096,
    2.162277660168379966876,
    Infinity,
  ];
  const x = fromTo(0, 10, 1).map((e) => e / 5);
  const params = {alpha: 1, beta: 2};

  distTests({Dist: Dist2, x, params, pdf, cdf, quantile});
});
