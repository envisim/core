import {Binomial as Dist, NegativeBinomial as Dist2} from '../src/binomial';
import {distTests, fromTo} from './_distributions.testf';

describe('binomial (10, 0.25)', () => {
  const pdf = [
    5.631351471e-2, 1.877117157e-1, 2.815675735e-1, 2.502822876e-1,
    1.459980011e-1, 5.839920044e-2, 1.622200012e-2, 3.089904785e-3,
    3.862380981e-4, 2.861022949e-5, 9.536743164e-7,
  ];
  const cdf = [
    0.05631351471, 0.24402523041, 0.52559280396, 0.77587509155, 0.92187309265,
    0.98027229309, 0.99649429321, 0.999584198, 0.9999704361, 0.99999904633, 1.0,
  ];
  const quantile = [0, 1, 1, 2, 2, 2, 3, 3, 4, 4, 10];
  const x = fromTo(0, 10, 1);
  const params = {n: 10, p: 0.25};

  distTests({Dist, x, params, pdf, cdf, quantile});
});

describe('binomial (100, 0.4)', () => {
  const cdf = [
    0.06150390959, 0.13033652891, 0.2386107144, 0.30680976227, 0.46207534089,
    0.54329448588, 0.62253267612, 0.76346881983, 0.82109836728, 0.90701990833,
    0.95769857981,
  ];
  const x = [32, 34, 36, 37, 39, 40, 41, 43, 44, 46, 48];
  const params = {n: 100, p: 0.4};
  distTests({
    Dist,
    x,
    params,
    pdf: [],
    cdf,
    quantile: [],
    doTests: [2, 4],
  });
});

describe('neg binomial (4, 0.7)', () => {
  const pdf = [
    0.0080999999999999995615, 0.039690000000000023872, 0.0680683500000000690777,
    0.0800483796000000386028, 0.0770465653649999998587,
    0.0654382161833399894624, 0.0510120639792855032346,
    0.0373565268525229352004, 0.0260841948747741331216,
    0.0175428996902892778142, 0.0114462803926587385062,
  ];
  const cdf = [
    0.0080999999999999978267, 0.0704699999999999771028,
    0.1941043499999999255579, 0.350389281599999768968, 0.5074842265649995853849,
    0.6448325704223403231907, 0.7541441360922376269116,
    0.8354495180653755959099, 0.8929131954962690187472,
    0.9319371968481370283044, 0.9576024590950301673686,
  ];
  const quantile = [0, 3, 5, 6, 7, 8, 10, 11, 14, 17, Infinity];
  const x = fromTo(0, 20, 2);
  const params = {n: 4, p: 0.7};

  distTests({Dist: Dist2, x, params, pdf, cdf, quantile});
});
